import{e as y,c as re,m as ne,n as A,S as _,f as F,g as P,h as M,i as T}from"./select-CIOnT5CX.js";import{a as ie,r as o,j as e}from"./app-DSyxH1s_.js";import{P as C,c as I,B as S,F as H,I as N,D as le,z as E,k as oe}from"./apis-DF2yDmUj.js";import{D as V,a as q,b as z,c as G}from"./dialog-B01DgXHb.js";import{B as de,E as ce}from"./badge-Bb8m2Inp.js";import{L as p}from"./label-B04qBNKo.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Fe=y("award",ue);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Pe=y("bell",me);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Me=y("house",he);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Te=y("log-out",xe);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Be=y("settings",fe);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ue=y("star",ge);var L={exports:{}},k={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B;function ve(){if(B)return k;B=1;var a=ie();function n(d,l){return d===l&&(d!==0||1/d===1/l)||d!==d&&l!==l}var i=typeof Object.is=="function"?Object.is:n,c=a.useState,t=a.useEffect,r=a.useLayoutEffect,x=a.useDebugValue;function m(d,l){var f=l(),b=c({inst:{value:f,getSnapshot:l}}),v=b[0].inst,s=b[1];return r(function(){v.value=f,v.getSnapshot=l,u(v)&&s({inst:v})},[d,f,l]),t(function(){return u(v)&&s({inst:v}),d(function(){u(v)&&s({inst:v})})},[d]),x(f),f}function u(d){var l=d.getSnapshot;d=d.value;try{var f=l();return!i(d,f)}catch{return!0}}function g(d,l){return l()}var j=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?g:m;return k.useSyncExternalStore=a.useSyncExternalStore!==void 0?a.useSyncExternalStore:j,k}var U;function pe(){return U||(U=1,L.exports=ve()),L.exports}var je=pe();function ye(){return je.useSyncExternalStore(be,()=>!0,()=>!1)}function be(){return()=>{}}var D="Avatar",[Ne]=re(D),[Se,O]=Ne(D),W=o.forwardRef((a,n)=>{const{__scopeAvatar:i,...c}=a,[t,r]=o.useState("idle");return e.jsx(Se,{scope:i,imageLoadingStatus:t,onImageLoadingStatusChange:r,children:e.jsx(C.span,{...c,ref:n})})});W.displayName=D;var K="AvatarImage",J=o.forwardRef((a,n)=>{const{__scopeAvatar:i,src:c,onLoadingStatusChange:t=()=>{},...r}=a,x=O(K,i),m=we(c,r),u=ne(g=>{t(g),x.onImageLoadingStatusChange(g)});return A(()=>{m!=="idle"&&u(m)},[m,u]),m==="loaded"?e.jsx(C.img,{...r,ref:n,src:c}):null});J.displayName=K;var Q="AvatarFallback",X=o.forwardRef((a,n)=>{const{__scopeAvatar:i,delayMs:c,...t}=a,r=O(Q,i),[x,m]=o.useState(c===void 0);return o.useEffect(()=>{if(c!==void 0){const u=window.setTimeout(()=>m(!0),c);return()=>window.clearTimeout(u)}},[c]),x&&r.imageLoadingStatus!=="loaded"?e.jsx(C.span,{...t,ref:n}):null});X.displayName=Q;function $(a,n){return a?n?(a.src!==n&&(a.src=n),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function we(a,{referrerPolicy:n,crossOrigin:i}){const c=ye(),t=o.useRef(null),r=c?(t.current||(t.current=new window.Image),t.current):null,[x,m]=o.useState(()=>$(r,a));return A(()=>{m($(r,a))},[r,a]),A(()=>{const u=d=>()=>{m(d)};if(!r)return;const g=u("loaded"),j=u("error");return r.addEventListener("load",g),r.addEventListener("error",j),n&&(r.referrerPolicy=n),typeof i=="string"&&(r.crossOrigin=i),()=>{r.removeEventListener("load",g),r.removeEventListener("error",j)}},[r,i,n]),x}var Y=W,Z=J,ee=X;const Ee=o.forwardRef(({className:a,...n},i)=>e.jsx(Y,{ref:i,className:I("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...n}));Ee.displayName=Y.displayName;const Ie=o.forwardRef(({className:a,...n},i)=>e.jsx(Z,{ref:i,className:I("aspect-square h-full w-full",a),...n}));Ie.displayName=Z.displayName;const Le=o.forwardRef(({className:a,...n},i)=>e.jsx(ee,{ref:i,className:I("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n}));Le.displayName=ee.displayName;const $e=({profile:a,open:n,onOpenChange:i,onEdit:c,onViewIncrement:t})=>(o.useEffect(()=>{n&&a&&t&&t()},[n,a,t]),a?e.jsxs(V,{open:n,onOpenChange:i,children:[e.jsxs(q,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(z,{children:e.jsx(G,{className:"text-2xl font-heading",children:"Profile Details"})}),e.jsxs("div",{className:"space-y-6 py-4",children:[a.image&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:a.image,alt:a.name,className:"w-32 h-32 rounded-full object-cover shadow-[var(--shadow-card)]"})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsx("p",{className:"text-lg font-semibold",children:a.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-lg",children:a.email})]}),a.phone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone Number"}),e.jsx("p",{className:"text-lg",children:a.phone})]}),a.businessType&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Business Type"}),e.jsx("p",{className:"text-lg",children:a.businessType})]}),a.state&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"State"}),e.jsx("p",{className:"text-lg",children:a.state})]}),a.dob&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date of Birth"}),e.jsx("p",{className:"text-lg",children:a.dob})]})]}),a.bio&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Bio"}),e.jsx("p",{className:"text-base mt-2 leading-relaxed",children:a.bio})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Membership Tier"}),e.jsx(de,{className:"mt-1 bg-primary text-primary-foreground",children:a.tier})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Profile Views"}),e.jsx("p",{className:"text-lg font-semibold",children:a.views})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[c&&e.jsx(S,{onClick:c,className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:"Edit Profile"}),e.jsx(S,{variant:"outline",onClick:()=>i(!1),children:"Close"})]})]})]}),e.jsx(H,{})]}):null),ae=o.forwardRef(({className:a,...n},i)=>e.jsx("textarea",{className:I("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:i,...n}));ae.displayName="Textarea";const He=({profile:a,open:n,onOpenChange:i,onSave:c})=>{const[t,r]=o.useState(null),[x,m]=o.useState({industry:[],region:[]}),[u,g]=o.useState(!1),[j,d]=o.useState(!0),[l,f]=o.useState(null);if(o.useEffect(()=>{a&&(r({...a}),typeof a.image=="string"&&a.image.trim()!==""?f(a.image):f(null))},[a]),o.useEffect(()=>()=>{l&&l.startsWith("blob:")&&URL.revokeObjectURL(l)},[l]),o.useEffect(()=>{(async()=>{try{const h=await le();h.status===200&&h.data.status===!0?m({industry:h.data.industry||[],region:h.data.region||[]}):E.error("Failed to load dropdown data.")}catch(h){console.error("Dropdown fetch error:",h),E.error("Unable to load dropdowns.")}finally{d(!1)}})()},[]),!t)return null;const b=s=>{const h=s.target.files?.[0];h&&(r(w=>({...w,image:h})),f(URL.createObjectURL(h)))},v=async()=>{g(!0);try{let s=t,h=!1;if(t.image instanceof File){const R=new FormData;Object.entries(t).forEach(([te,se])=>{R.append(te,se??"")}),s=R,h=!0}const w=await oe(s,h);if(w.status===200)c(t),E.success(w.data.message||"Profile updated successfully",{duration:2e3}),i(!1);else throw new Error("Failed to update profile")}catch(s){console.error("Error updating profile:",s),E.error("Failed to update profile. Please try again.")}finally{g(!1)}};return e.jsxs(V,{open:n,onOpenChange:i,children:[e.jsxs(q,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(z,{children:e.jsx(G,{className:"text-2xl font-heading",children:"Edit Profile"})}),j?e.jsx("div",{className:"text-center py-6",children:"Loading dropdown data..."}):e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",children:"Full Name"}),e.jsx(N,{id:"name",value:t.name||"",onChange:s=>r({...t,name:s.target.value.trimStart()})})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"email",children:"Email Address"}),e.jsx(N,{id:"email",type:"email",value:t.email||"",onChange:s=>r({...t,email:s.target.value.trimStart()})})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"phone",children:"Phone Number"}),e.jsx(N,{id:"phone",value:t.phone||"",onChange:s=>r({...t,phone:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"industry",children:"Industry"}),e.jsxs(_,{value:t.businessId?t.businessId.toString():"",onValueChange:s=>r({...t,businessId:parseInt(s)}),children:[e.jsx(F,{className:"w-full",children:e.jsx(P,{placeholder:x.industry.find(s=>s.industryId===t.businessId)?.industryName||"-- Select Industry --"})}),e.jsx(M,{children:x.industry.map(s=>e.jsx(T,{value:s.industryId.toString(),children:s.industryName},s.industryId))})]})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"region",children:"Region"}),e.jsxs(_,{value:t.stateId?t.stateId.toString():"",onValueChange:s=>r({...t,stateId:parseInt(s)}),children:[e.jsx(F,{className:"w-full",children:e.jsx(P,{placeholder:x.region.find(s=>s.regionId===t.stateId)?.regionName||"-- Select Region --"})}),e.jsx(M,{children:x.region.map(s=>e.jsx(T,{value:s.regionId.toString(),children:s.regionName},s.regionId))})]})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"dob",children:"Date of Birth"}),e.jsx(N,{id:"dob",type:"date",value:t.dob||"",onChange:s=>r({...t,dob:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"bio",children:"Bio"}),e.jsx(ae,{id:"bio",rows:4,value:t.bio||"",onChange:s=>r({...t,bio:s.target.value}),placeholder:"Tell us about yourself and your business..."})]}),e.jsxs("div",{className:"flex flex-col items-start gap-3",children:[e.jsx(p,{htmlFor:"image",children:"Profile Picture"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l||(typeof t.image=="string"?t.image:"https://cdn-icons-png.flaticon.com/512/847/847969.png"),alt:"Profile",className:"h-28 w-28 rounded-full object-cover border shadow-sm"}),l&&e.jsx("button",{type:"button",onClick:()=>{r({...t,image:null}),f(null)},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full text-xs px-1.5 py-0.5 hover:bg-red-600",children:"âœ•"})]}),e.jsxs("div",{children:[e.jsx(N,{id:"image",type:"file",accept:"image/*",className:"hidden",onChange:b}),e.jsx(S,{type:"button",variant:"outline",onClick:()=>document.getElementById("image").click(),children:l?"Change Photo":"Upload Photo"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(S,{onClick:v,className:"bg-primary hover:bg-primary/90 text-primary-foreground",disabled:u,children:u?"Saving...":"Save Changes"}),e.jsx(S,{variant:"outline",onClick:()=>i(!1),disabled:u,children:"Cancel"})]})]})]}),e.jsx(H,{})]})};export{Fe as A,Pe as B,He as E,Me as H,Te as L,$e as P,Ue as S,ae as T,Be as a,Ee as b,Le as c,Ie as d};
