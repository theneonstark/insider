import{j as e,r as m}from"./app-BYrpPC0m.js";import{C as N,a as b,b as S,d as v,e as P,g as k,B as h}from"./index-HcTyGvT5.js";import{C as w}from"./select-ChA0sti4.js";import{D as E,a as D,b as z,c as T,e as _}from"./ProfileViewModal-CNk6iqJV.js";import{L}from"./label-cYn9eqbe.js";import{E as O,l as Y,u as F,a as M,C as u}from"./react-stripe.esm-D2vk-yZq.js";import{z as x}from"./apis-z0zUX_NR.js";import{c as y}from"./createLucideIcon-C9XGego4.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],B=y("credit-card",R);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$=y("lock",I),W=({title:s,price:a,features:t=[],highlighted:n=!1,onJoin:o})=>e.jsxs(N,{className:`animate-fade-in hover-lift relative transition-all ${n?"border-2 border-primary shadow-lg":""}`,children:[n&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx("span",{className:"bg-primary text-primary-foreground px-3 py-1 rounded-full text-xs font-semibold",children:"MOST POPULAR"})}),e.jsxs(b,{className:"pt-8",children:[e.jsx(S,{className:"text-2xl text-primary",children:s}),e.jsx(v,{className:"text-3xl font-bold text-foreground mt-2",children:a})]}),e.jsx(P,{children:e.jsxs("ul",{className:"space-y-3",children:[(Array.isArray(t)?t:[]).map((d,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm",children:d})]},p)),(!t||t.length===0)&&e.jsx("li",{className:"text-sm text-muted-foreground italic",children:"No features listed"})]})}),e.jsx(k,{children:e.jsxs(h,{onClick:o,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground font-medium",children:["Join ",s]})})]}),A=Y("pk_test_51KK8rzL1r3PzNdUEpPZaQ5kitAm7ys2nrZsrNPKRTnJCRBYlLxBm6udmCXZs0RSY35YekBUYL3vOSYvhpgz3SQPT009nJGeGov"),J=({tier:s,onClose:a})=>{const t=F(),n=M(),[o,d]=m.useState(!1),[p,i]=m.useState(null),[c,j]=m.useState(""),[f,g]=m.useState(!1);m.useEffect(()=>{if(!c&&s?.price){const l=Math.round(parseFloat(s.price.replace(/[^0-9.-]+/g,""))*100);fetch("/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({amount:l,plan_title:s.title,tier_id:s.id})}).then(r=>r.json()).then(r=>{r.clientSecret?j(r.clientSecret):i("Invalid response from server")}).catch(()=>{i("Network error"),x.error("Failed to initialize payment. Try again.")})}},[s,c]);const C=async l=>{if(l.preventDefault(),!t||!n||!c||!f)return;d(!0),i(null);const{error:r,paymentIntent:K}=await t.confirmCardPayment(c,{payment_method:{card:n.getElement(u)}});r?(i(r.message),x.error(r.message||"Payment failed")):(x.success(`Subscribed to ${s.title} for ${s.price}! ðŸŽ‰`),a()),d(!1)};return e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Card Details"}),e.jsx("div",{className:"p-3 border rounded-md bg-white",children:e.jsx(u,{onChange:l=>{g(l.complete),i(l.error?.message||null)},options:{style:{base:{fontSize:"16px",color:"#1f2937","::placeholder":{color:"#9ca3af"}}}}})})]}),p&&e.jsx("p",{className:"text-sm text-red-600",children:p}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground bg-muted/50 p-3 rounded-md",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Your payment information is secure and encrypted"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:a,disabled:o,className:"flex-1",children:"Cancel"}),e.jsx(h,{type:"submit",disabled:o||!t||!n||!c||!f,className:"flex-1",children:o?"Processing...":`Pay ${s.price}`})]})]})},ee=({isOpen:s,onClose:a,tier:t})=>t?e.jsx(e.Fragment,{children:e.jsx(E,{open:s,onOpenChange:a,children:e.jsxs(D,{className:"sm:max-w-md",children:[e.jsxs(z,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-primary"}),"Complete Your Payment"]}),e.jsxs(_,{children:["Subscribe to ",t.title," for ",t.price]})]}),e.jsx(O,{stripe:A,children:e.jsx(J,{tier:t,onClose:a})})]})})}):null;export{B as C,W as M,ee as P};
